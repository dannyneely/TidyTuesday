library(tidyverse)
library(modeldata)
library(forecast)
data("Chicago")
Chicago %>%
glimpse()
library(lubridate)
#Need to clean up and evaluate the timeseries components
Chicago %>%
select(ridership, date) %>%
ggplot(aes(x = date, y = ridership)) +
geom_line()
Chicago <- Chicago %>%
select(ridership, date)
Chicago %>%
mutate(month_name = month.abb[month(date)],
month = month(date),
year = year(date)) %>%
mutate(year = as.factor(year)) %>%
ggplot(aes(x = month, y = ridership, color = year)) + geom_smooth(se = FALSE)
Chicago <- Chicago %>%
select(ridership, date)
Chicago %>%
mutate(month_name = month.abb[month(date)],
month = month(date),
year = year(date)) %>%
mutate(year = as.factor(year)) %>%
ggplot(aes(x = month, y = ridership, color = year)) + geom_smooth(se = FALSE)
Chicago %>%
ts() %>%
mstl() %>%
autoplot()
Chicago %>%
select(ridership) %>%
ts() %>%
ggtsdisplay()
#We suspect this data is non-stationary so we will try using differencing
Chicago %>%
mutate(ridership_daily_change = ridership - lag(ridership, 1)) %>%
ggplot(aes(x = date, y = ridership_daily_change)) + geom_line()
Chicago <- Chicago %>%
mutate(ridership_daily_change = ridership - lag(ridership, 1))
Chicago %>%
select(ridership_daily_change) %>%
ts() %>%
ggtsdisplay()
Chicago %>%
select(ridership_daily_change) %>%
ts() %>%
mstl() %>%
autoplot()
